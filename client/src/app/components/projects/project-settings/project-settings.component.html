<app-navbar></app-navbar>

<div class="settings-page">
	<div class="header-row">
		<div></div>
		<div class="project-title-pill">{{ project()?.title }}</div>
	</div>

	<div class="accordion">
		<div class="accordion-item" [class.open]="open.details">
			<button class="accordion-header" (click)="toggle('details')">
				Project Details
				<span class="accordion-icon">{{ open.details ? 'âˆ’' : '+' }}</span>
			</button>
			<div class="accordion-body" *ngIf="open.details">
				<div class="details-card">
					<label>Project Title</label>
					<div class="field">{{ project()?.title }}</div>

					<label>Project Description</label>
					<div class="field">{{ project()?.description }}</div>

					<div class="created">Created On {{ project()?.created_at | date }}</div>
					<div class="created"><button class="delete-project" (click)="deleteProject()">Delete Project</button></div>		
				</div>
			</div>
		</div>

		<div class="accordion-item" [class.open]="open.members">
			<button class="accordion-header" (click)="toggle('members')">
				Project Members
				<span class="accordion-icon">{{ open.members ? 'âˆ’' : '+' }}</span>
			</button>
			<div class="accordion-body" *ngIf="open.members">
                <div class="members-card">
					<div class="add-row">
						<input type="email" placeholder="member@example.com" [formControl]="memberEmailControl" />
						<button class="add-member" (click)="addMemberByEmail()"><span>+</span> Add</button>
					</div>
					<div class="error-message" *ngIf="addMemberError()">{{ addMemberError() }}</div>
                    <div class="member-list">
                        <div class="member-item" *ngFor="let m of project()?.members">
                            <span class="member-avatar">ðŸ‘¤</span>
                            <span class="member-name">{{m.first_name}} {{m.last_name}}</span>
                            <button class="remove-btn" (click)="removeMember(m.email)">Ã—</button>
                        </div>
                    </div>
                </div>
			</div>
		</div>

		<div class="accordion-item" [class.open]="open.managers">
			<button class="accordion-header" (click)="toggle('managers')">
				Project Managers
				<span class="accordion-icon">{{ open.managers ? 'âˆ’' : '+' }}</span>
			</button>
			<div class="accordion-body" *ngIf="open.managers">
                <div class="members-card">
					<div class="add-row">
						<input type="email" placeholder="manager@example.com" [formControl]="managerEmailControl" />
						<button class="add-member" (click)="addManagerByEmail()"><span>+</span> Add</button>
					</div>
					<div class="error-message" *ngIf="addManagerError()">{{ addManagerError() }}</div>
                    <div class="member-list">
                        <div class="member-item" *ngFor="let m of project()?.managers">
                            <span class="member-avatar">ðŸ‘¤</span>
                            <span class="member-name">{{m.first_name}} {{m.last_name}}</span>
                            <button class="remove-btn" (click)="removeManager(m.email)">Ã—</button>
                        </div>
                    </div>
                </div>
			</div>
		</div>

	</div>
</div>
